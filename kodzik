Sub KopiujZTransakcji()
    Dim Wartosc As Variant
    Dim Arkusz1 As Worksheet
    Dim ArkuszTransakcje As Worksheet
    Dim OstatniWiersz As Long
    
    ' Ustal wartość do wyszukania w komórce A2 na Arkusz1
    Set Arkusz1 = ThisWorkbook.Sheets("Arkusz1")
    Wartosc = Arkusz1.Range("A2").Value
    
    ' Ustal arkusz "Transakcje" w skoroszycie
    Set ArkuszTransakcje = ThisWorkbook.Sheets("Transakcje")
    
    ' Znajdź ostatni wiersz w kolumnie B na arkuszu "Transakcje"
    OstatniWiersz = ArkuszTransakcje.Cells(ArkuszTransakcje.Rows.Count, "B").End(xlUp).Row
    
    ' Przeszukaj kolumnę B w arkuszu "Transakcje" i skopiuj wartość z kolumny BU do komórki D2 na Arkusz1
    For i = 1 To OstatniWiersz
        If ArkuszTransakcje.Cells(i, "B").Value = Wartosc Then
            Arkusz1.Range("D2").Value = ArkuszTransakcje.Cells(i, "BU").Value
            Exit For
        End If
    Next i
    
    ' Jeśli nie znaleziono wartości, wyświetl komunikat
    If IsEmpty(Arkusz1.Range("D2").Value) Then
        MsgBox "Wartość nie została znaleziona w kolumnie B na arkuszu 'Transakcje'."
    End If
End Sub
